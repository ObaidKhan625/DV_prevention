<style>
    .gradient-custom-2 {
        /* fallback for old browsers */
        background: #FFAFBD;  /* fallback for old browsers */
        background: -webkit-linear-gradient(to right, #ffc3a0, #FFAFBD);  /* Chrome 10-25, Safari 5.1-6 */
        background: linear-gradient(to right, #ffc3a0, #FFAFBD); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
    }

    @media (min-width: 768px) {
        .gradient-form {
        height: 100vh !important;
        }
    }
    @media (min-width: 769px) {
        .gradient-custom-2 {
        border-top-right-radius: .3rem;
        border-bottom-right-radius: .3rem;
        }
    }
    #messages{
        background-color: grey;
        color: #fff;
        padding: 10px;
        margin-top: 10px;
    }
</style>

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" integrity="sha384-gfdkjb5BdAXd+lj+gudLWI+BXq4IuLW5IT+brZEZsLFm++aCMlF1V92rMkPaX4PP" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/css?family=Aguafina+Script|Dancing+Script|Kaushan+Script|Open+Sans|Petit+Formal+Script|Pinyon+Script|Roboto|Rouge+Script" rel="stylesheet">

<style>
  .notification {
      background-color: #0d6efd;
      color: white;
      text-decoration: none;
      padding: 4px 24px;
      margin-right: 20px;
      margin-left: 20px;
      position: relative;
      display: inline-block;
      border-radius: 2px;
      font-size: 20px;
  }

  .notification:hover {
      background: #0b5ed7;
      color: #fff;
  }

  .notification .badge {
      position: absolute;
      top: -10px;
      right: -10px;
      padding: 8px 8px;
      border-radius: 50%;
      background: red;
      color: white;
  }

  .notification-section .dropdown-toggle::after {
      content: none;
  }

  .dropdown-toggle::after {
      color: #fff;
  }

  #notifications-dropdown li {
      max-width: 500px;
      word-wrap: break-word;
      display: inline-block;
      white-space: normal;
  }

  #notifications-dropdown.dropdown-menu {
      width: 15rem;
  }
    
</style>

<li class="nav-item dropdown notification-section">
  <a href="#" class="notification dropdown-toggle" id="navbarDropdown" role="button"
      data-bs-toggle="dropdown" aria-expanded="true">
      <span><i class='fa fa-bell'></i></span>
      <span class="badge" id="notification-badge">0</span>
  </a>
  <ul class="dropdown-menu" aria-labelledby="navbarDropdown" id="notifications-dropdown"
      data-popper-placement="bottom-end"
      style="position: absolute; inset: 0px auto auto 0px; margin: 0px; transform: translate3d(-70px, 42px, 0px);">
      
      {% for i in notifications %}
      <li class="dropdown-item">{{i.message}}</li>
      <hr class="dropdown-divider">
      {% endfor %}
      {% comment %} <li class='dropdown-item'>Hello</li>
      <hr class="dropdown-divider"> {% endcomment %}
  </ul>
</li>

{{ room_name|json_script:"room-name" }}
  <script>
    const roomName = JSON.parse(document.getElementById('room-name').textContent);

    const notificationSocket = new WebSocket(
        'ws://'
        + window.location.host
        + '/ws/notification/'
        + roomName
        + '/'
    );

    notificationSocket.onmessage = function(e) {
        const data = JSON.parse(e.data);
        //document.querySelector('#chat-log').value += (data.message + '\n');
        console.log(data);
        document.getElementById("notifications-dropdown").innerHTML = "<li class='dropdown-item'>" + data + "</li><hr class='dropdown-divider'>" + document.getElementById("notifications-dropdown").innerHTML;
        document.getElementById("notification-badge").innerHTML = parseInt(document.getElementById("notification-badge").innerHTML) + 1;
    };

    notificationSocket.onclose = function(e) {
        console.error('Chat socket closed unexpectedly');
    }; 
  </script>
<section class="h-100 gradient-form" style="background-color: #eee;">
    <div class="container py-5 h-100">
      <div class="row d-flex justify-content-center align-items-center h-100">
        <div class="col-xl-10">
          <div class="card rounded-3 text-black">
            <div class="row g-0">
              <div class="col-lg-6">
                <div class="card-body p-md-5 mx-md-4">
  
                  <!-- <div class="text-center">
                    <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-login-form/lotus.webp"
                      style="width: 185px;" alt="logo">
                    <h4 class="mt-1 mb-5 pb-1">We are The Lotus Team</h4>
                  </div> -->
  
                  <form method="POST" action="">
                    {% csrf_token %}
                    <p style="text-align: center;">Please login to your account</p>
  
                    <div class="form-outline mb-4">
                        <input type="text"  id="form2Example11" name="username" placeholder="Username..." class="form-control">
                        <label class="form-label" for="form2Example11">Username</label>
                    </div>
  
                    <div class="form-outline mb-4">
                        <input type="password" id="form2Example22"  name="password" placeholder="Password..." class="form-control" />
                        <label class="form-label" for="form2Example22">Password</label>
                    </div>

                    {% for message in messages %}
                    <p id="messages">{{message}}</p>
                    {% endfor %}
  
                    <div class="text-center pt-1 mb-5 pb-1">
                        <div class="pt-1 mb-4">
                            <input class="btn btn-lg btn-block gradient-custom-2" type="submit" value="Login">
                        </div>
                    </div>
                    
                    <div class="d-flex align-items-center justify-content-center pb-4">
                      <p class="mb-0 me-2">Don't have an account?</p>
                      <a href="{% url 'user-auth:register' %}" class="ml-2"><button type="button" class="btn btn-outline-danger ml-3">Create new</button></a>
                    </div>
  
                  </form>
  
                </div>
              </div>
              <div class="col-lg-6 d-flex align-items-center gradient-custom-2">
                <div class="text-black px-3 py-4 p-md-5 mx-md-4">
                  <h4 class="mb-4">We are more than just a company</h4>
                  <p class="small mb-0">An initiative to reduce Domestic Violence across India</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>